import{e as w,u as b,b as S,r as v,j as e,B as d,L as h,v as P}from"./index-CROi_bFZ.js";import{I as c}from"./input-BF63-rU5.js";import{L as o}from"./label-kHtJxQ_W.js";import{S as A,a as E,b as L,c as _,d as x}from"./select-B-rD1Ibz.js";import{C as D,a as F,b as I,c as U,d as k}from"./card-B-0H7GP8.js";import{A as q}from"./arrow-left-BPDy95mI.js";const J=()=>{const g=w(),{user:m}=b(),{toast:l}=S(),[p,j]=v.useState(!1),[s,f]=v.useState({full_name:"",email:"",password:"",confirmPassword:"",role:"stakeholder"}),C=(m==null?void 0:m.role)==="admin",n=t=>{const{name:a,value:i}=t.target;f(r=>({...r,[a]:i}))},y=t=>{f(a=>({...a,role:t}))},N=async t=>{var a,i;if(t.preventDefault(),s.password!==s.confirmPassword){l({variant:"destructive",title:"Error",description:"Las contraseñas no coinciden."});return}if(s.password.length<8){l({variant:"destructive",title:"Error",description:"La contraseña debe tener al menos 8 caracteres."});return}try{j(!0);const r={full_name:s.full_name,email:s.email,password:s.password,role:s.role},u=await P.createUser(r);l({title:"Usuario creado",description:"El usuario ha sido creado exitosamente."}),g(`/users/${u.data.data.user.id}`)}catch(r){console.error("Error creating user:",r);const u=((i=(a=r.response)==null?void 0:a.data)==null?void 0:i.message)||"No se pudo crear el usuario. Inténtalo de nuevo.";l({variant:"destructive",title:"Error",description:u})}finally{j(!1)}};return C?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(d,{variant:"ghost",size:"sm",asChild:!0,className:"mr-2",children:e.jsxs(h,{to:"/users",children:[e.jsx(q,{className:"h-4 w-4 mr-1"}),"Volver"]})}),e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Crear Nuevo Usuario"})]})}),e.jsx("form",{onSubmit:N,children:e.jsxs("div",{className:"grid gap-6 max-w-2xl mx-auto",children:[e.jsxs(D,{children:[e.jsxs(F,{children:[e.jsx(I,{children:"Información del Usuario"}),e.jsx(U,{children:"Ingresa los datos del nuevo usuario"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"full_name",children:"Nombre Completo *"}),e.jsx(c,{id:"full_name",name:"full_name",value:s.full_name,onChange:n,placeholder:"Ej: Juan Pérez",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"email",children:"Correo Electrónico *"}),e.jsx(c,{id:"email",name:"email",type:"email",value:s.email,onChange:n,placeholder:"correo@ejemplo.com",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"role",children:"Rol *"}),e.jsxs(A,{value:s.role,onValueChange:y,children:[e.jsx(E,{children:e.jsx(L,{placeholder:"Selecciona un rol"})}),e.jsxs(_,{children:[e.jsx(x,{value:"admin",children:"Administrador"}),e.jsx(x,{value:"analyst",children:"Analista"}),e.jsx(x,{value:"stakeholder",children:"Stakeholder"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.role==="admin"?"Acceso completo a todas las funcionalidades del sistema.":s.role==="analyst"?"Puede gestionar proyectos y realizar análisis de QA.":"Puede ver proyectos y añadir comentarios."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"password",children:"Contraseña *"}),e.jsx(c,{id:"password",name:"password",type:"password",value:s.password,onChange:n,placeholder:"••••••••",required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"La contraseña debe tener al menos 8 caracteres."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"confirmPassword",children:"Confirmar Contraseña *"}),e.jsx(c,{id:"confirmPassword",name:"confirmPassword",type:"password",value:s.confirmPassword,onChange:n,placeholder:"••••••••",required:!0})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(d,{variant:"outline",type:"button",asChild:!0,children:e.jsx(h,{to:"/users",children:"Cancelar"})}),e.jsx(d,{type:"submit",disabled:p,children:p?"Creando...":"Crear Usuario"})]})]})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Acceso Restringido"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No tienes permisos para acceder a esta sección."}),e.jsx(d,{asChild:!0,children:e.jsx(h,{to:"/dashboard",children:"Volver al Dashboard"})})]})};export{J as default};
