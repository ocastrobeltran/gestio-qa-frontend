import{u as A,r,j as e,g as T,B as y,L as u,p as k}from"./index-CYuDxeVZ.js";import{I as L}from"./input-DzyvJJh-.js";import{S as F,a as B,b as I,c as D,d as i}from"./select-BERQyZpp.js";import{S as H,F as V,T as $,a as Q,b as j,c as l,d as R,e as t}from"./table-gIOeb17S.js";import{C as _,a as q,b as z,c as G,d as J}from"./card-B2R_5Mvu.js";import{P as K}from"./plus-adGqTkVZ.js";const Z=()=>{const{user:n}=A(),[m,x]=r.useState([]),[f,d]=r.useState([]),[C,p]=r.useState(!0),[o,S]=r.useState(""),[c,N]=r.useState(""),w=(n==null?void 0:n.role)==="admin",E=(n==null?void 0:n.role)==="analyst",P=w||E;return r.useEffect(()=>{(async()=>{try{p(!0);const a=await k.getProjects();a&&a.data&&a.data.data&&Array.isArray(a.data.data.projects)?(x(a.data.data.projects),d(a.data.data.projects)):(console.error("Formato inesperado de respuesta:",a),x([]),d([]))}catch(a){console.error("Error fetching projects:",a),x([]),d([])}finally{p(!1)}})()},[]),r.useEffect(()=>{let s=[...m];if(o){const a=o.toLowerCase();s=s.filter(h=>{var g,b,v;return(((g=h.title)==null?void 0:g.toLowerCase())||"").includes(a)||(((b=h.client)==null?void 0:b.toLowerCase())||"").includes(a)||(((v=h.initiative)==null?void 0:v.toLowerCase())||"").includes(a)})}c&&c!=="all"&&(s=s.filter(a=>a.status===c)),d(s)},[o,c,m]),C?e.jsx(T,{fullScreen:!1}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Proyectos"}),P&&e.jsx(y,{asChild:!0,children:e.jsxs(u,{to:"/projects/create",children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Nuevo Proyecto"]})})]}),e.jsxs(_,{children:[e.jsxs(q,{children:[e.jsx(z,{children:"Lista de Proyectos"}),e.jsx(G,{children:"Gestiona todos los proyectos de QA en el sistema"})]}),e.jsxs(J,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(H,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(L,{type:"search",placeholder:"Buscar por título, cliente o iniciativa...",className:"pl-8",value:o,onChange:s=>S(s.target.value)})]}),e.jsx("div",{className:"w-full md:w-[200px]",children:e.jsxs(F,{value:c,onValueChange:N,children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),e.jsx(I,{placeholder:"Filtrar por estado"})]})}),e.jsxs(D,{children:[e.jsx(i,{value:"all",children:"Todos los estados"}),e.jsx(i,{value:"En análisis",children:"En análisis"}),e.jsx(i,{value:"En validación",children:"En validación"}),e.jsx(i,{value:"En pruebas",children:"En pruebas"}),e.jsx(i,{value:"Aprobado",children:"Aprobado"}),e.jsx(i,{value:"Cancelado",children:"Cancelado"})]})]})})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs($,{children:[e.jsx(Q,{children:e.jsxs(j,{children:[e.jsx(l,{children:"Título"}),e.jsx(l,{children:"Cliente"}),e.jsx(l,{children:"Iniciativa"}),e.jsx(l,{children:"Estado"}),e.jsx(l,{children:"Analista QA"}),e.jsx(l,{children:"Fecha Creación"}),e.jsx(l,{className:"text-right",children:"Acciones"})]})}),e.jsx(R,{children:f.length>0?f.map(s=>{var a;return e.jsxs(j,{children:[e.jsx(t,{className:"font-medium",children:e.jsx(u,{to:`/projects/${s.id}`,className:"hover:underline text-primary",children:s.title})}),e.jsx(t,{children:s.client}),e.jsx(t,{children:s.initiative}),e.jsx(t,{children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${s.status==="Aprobado"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":s.status==="Cancelado"?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300":s.status==="En pruebas"?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300":s.status==="En validación"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"}`,children:s.status})}),e.jsx(t,{children:((a=s.qaAnalyst)==null?void 0:a.full_name)||"Sin asignar"}),e.jsx(t,{children:new Date(s.created_at).toLocaleDateString()}),e.jsx(t,{className:"text-right",children:e.jsx(y,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(u,{to:`/projects/${s.id}`,children:"Ver detalles"})})})]},s.id)}):e.jsx(j,{children:e.jsx(t,{colSpan:7,className:"h-24 text-center",children:"No se encontraron proyectos"})})})]})})]})]})]})};export{Z as default};
