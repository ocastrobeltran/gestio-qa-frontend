import{f as z,u as E,b as L,r as f,j as e,A as I,n as q,o as k,q as M,a7 as D,l as B,B as w,c as v}from"./index-CYuDxeVZ.js";import{I as o}from"./input-DzyvJJh-.js";import{L as c}from"./label-Bv7pHFfe.js";import{C as P,a as g,b as y,c as N,d as C}from"./card-B2R_5Mvu.js";import{T as G,a as K,b,c as A}from"./tabs-B4dp_e8w.js";import{M as U}from"./mail-r8FGgm1A.js";const H=z("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),X=()=>{const{user:a,updateUser:T}=E(),{toast:i}=L(),[d,m]=f.useState(!1),[u,_]=f.useState({full_name:(a==null?void 0:a.full_name)||"",email:(a==null?void 0:a.email)||""}),[t,p]=f.useState({currentPassword:"",newPassword:"",confirmPassword:""}),j=l=>{const{name:r,value:n}=l.target;_(s=>({...s,[r]:n}))},h=l=>{const{name:r,value:n}=l.target;p(s=>({...s,[r]:n}))},F=async l=>{var r,n;if(l.preventDefault(),!!a)try{m(!0);const s=await v.updateProfile({full_name:u.full_name,email:u.email});T(s.data.data.user),i({title:"Perfil actualizado",description:"Tu información de perfil ha sido actualizada exitosamente."})}catch(s){console.error("Error updating profile:",s);const x=((n=(r=s.response)==null?void 0:r.data)==null?void 0:n.message)||"No se pudo actualizar el perfil. Inténtalo de nuevo.";i({variant:"destructive",title:"Error",description:x})}finally{m(!1)}},S=async l=>{var r,n;if(l.preventDefault(),t.newPassword!==t.confirmPassword){i({variant:"destructive",title:"Error",description:"Las contraseñas no coinciden."});return}if(t.newPassword.length<8){i({variant:"destructive",title:"Error",description:"La nueva contraseña debe tener al menos 8 caracteres."});return}try{m(!0),await v.updatePassword(t.currentPassword,t.newPassword),p({currentPassword:"",newPassword:"",confirmPassword:""}),i({title:"Contraseña actualizada",description:"Tu contraseña ha sido actualizada exitosamente."})}catch(s){console.error("Error updating password:",s);const x=((n=(r=s.response)==null?void 0:r.data)==null?void 0:n.message)||"No se pudo actualizar la contraseña. Inténtalo de nuevo.";i({variant:"destructive",title:"Error",description:x})}finally{m(!1)}};return a?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Mi Perfil"}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-5",children:[e.jsxs(P,{className:"md:col-span-2",children:[e.jsxs(g,{children:[e.jsx(y,{children:"Información Personal"}),e.jsx(N,{children:"Tu información de perfil en el sistema"})]}),e.jsxs(C,{className:"flex flex-col items-center text-center",children:[e.jsxs(I,{className:"h-24 w-24 mb-4",children:[e.jsx(q,{src:"/placeholder.svg",alt:a.full_name}),e.jsx(k,{className:"text-2xl",children:M(a.full_name)})]}),e.jsx("h2",{className:"text-xl font-semibold",children:a.full_name}),e.jsx("p",{className:"text-muted-foreground",children:a.email}),e.jsxs("div",{className:"mt-2 flex items-center justify-center",children:[e.jsx(D,{className:"h-4 w-4 mr-1 text-primary"}),e.jsx("span",{className:"capitalize",children:a.role==="admin"?"Administrador":a.role==="analyst"?"Analista":"Stakeholder"})]})]})]}),e.jsxs(P,{className:"md:col-span-3",children:[e.jsxs(g,{children:[e.jsx(y,{children:"Configuración de Cuenta"}),e.jsx(N,{children:"Administra tu información y seguridad"})]}),e.jsx(C,{children:e.jsxs(G,{defaultValue:"profile",children:[e.jsxs(K,{className:"mb-4",children:[e.jsx(b,{value:"profile",children:"Perfil"}),e.jsx(b,{value:"password",children:"Contraseña"})]}),e.jsx(A,{value:"profile",children:e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"full_name",children:[e.jsx(B,{className:"h-4 w-4 inline mr-1"}),"Nombre Completo"]}),e.jsx(o,{id:"full_name",name:"full_name",value:u.full_name,onChange:j,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"email",children:[e.jsx(U,{className:"h-4 w-4 inline mr-1"}),"Correo Electrónico"]}),e.jsx(o,{id:"email",name:"email",type:"email",value:u.email,onChange:j,required:!0})]}),e.jsx(w,{type:"submit",disabled:d,children:d?"Guardando...":"Guardar Cambios"})]})}),e.jsx(A,{value:"password",children:e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"currentPassword",children:[e.jsx(H,{className:"h-4 w-4 inline mr-1"}),"Contraseña Actual"]}),e.jsx(o,{id:"currentPassword",name:"currentPassword",type:"password",value:t.currentPassword,onChange:h,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"newPassword",children:"Nueva Contraseña"}),e.jsx(o,{id:"newPassword",name:"newPassword",type:"password",value:t.newPassword,onChange:h,required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"La contraseña debe tener al menos 8 caracteres."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"confirmPassword",children:"Confirmar Nueva Contraseña"}),e.jsx(o,{id:"confirmPassword",name:"confirmPassword",type:"password",value:t.confirmPassword,onChange:h,required:!0})]}),e.jsx(w,{type:"submit",disabled:d,children:d?"Actualizando...":"Actualizar Contraseña"})]})})]})})]})]})]}):null};export{X as default};
