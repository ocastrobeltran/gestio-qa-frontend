import{f as S,u as E,b as L,r as f,j as e,A as k,o as I,q,s as M,m as D,B as w,c as v}from"./index-CROi_bFZ.js";import{I as o}from"./input-BF63-rU5.js";import{L as c}from"./label-kHtJxQ_W.js";import{C as P,a as g,b as y,c as N,d as C}from"./card-B-0H7GP8.js";import{T as B,a as G,b,c as A}from"./tabs-wem10j3N.js";import{M as K}from"./mail-B2Msq4VA.js";const U=S("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),V=S("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),X=()=>{const{user:a,updateUser:T}=E(),{toast:i}=L(),[d,m]=f.useState(!1),[u,_]=f.useState({full_name:(a==null?void 0:a.full_name)||"",email:(a==null?void 0:a.email)||""}),[n,p]=f.useState({currentPassword:"",newPassword:"",confirmPassword:""}),j=l=>{const{name:r,value:t}=l.target;_(s=>({...s,[r]:t}))},h=l=>{const{name:r,value:t}=l.target;p(s=>({...s,[r]:t}))},F=async l=>{var r,t;if(l.preventDefault(),!!a)try{m(!0);const s=await v.updateProfile({full_name:u.full_name,email:u.email});T(s.data.data.user),i({title:"Perfil actualizado",description:"Tu información de perfil ha sido actualizada exitosamente."})}catch(s){console.error("Error updating profile:",s);const x=((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||"No se pudo actualizar el perfil. Inténtalo de nuevo.";i({variant:"destructive",title:"Error",description:x})}finally{m(!1)}},z=async l=>{var r,t;if(l.preventDefault(),n.newPassword!==n.confirmPassword){i({variant:"destructive",title:"Error",description:"Las contraseñas no coinciden."});return}if(n.newPassword.length<8){i({variant:"destructive",title:"Error",description:"La nueva contraseña debe tener al menos 8 caracteres."});return}try{m(!0),await v.updatePassword(n.currentPassword,n.newPassword),p({currentPassword:"",newPassword:"",confirmPassword:""}),i({title:"Contraseña actualizada",description:"Tu contraseña ha sido actualizada exitosamente."})}catch(s){console.error("Error updating password:",s);const x=((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||"No se pudo actualizar la contraseña. Inténtalo de nuevo.";i({variant:"destructive",title:"Error",description:x})}finally{m(!1)}};return a?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Mi Perfil"}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-5",children:[e.jsxs(P,{className:"md:col-span-2",children:[e.jsxs(g,{children:[e.jsx(y,{children:"Información Personal"}),e.jsx(N,{children:"Tu información de perfil en el sistema"})]}),e.jsxs(C,{className:"flex flex-col items-center text-center",children:[e.jsxs(k,{className:"h-24 w-24 mb-4",children:[e.jsx(I,{src:"/placeholder.svg",alt:a.full_name}),e.jsx(q,{className:"text-2xl",children:M(a.full_name)})]}),e.jsx("h2",{className:"text-xl font-semibold",children:a.full_name}),e.jsx("p",{className:"text-muted-foreground",children:a.email}),e.jsxs("div",{className:"mt-2 flex items-center justify-center",children:[e.jsx(V,{className:"h-4 w-4 mr-1 text-primary"}),e.jsx("span",{className:"capitalize",children:a.role==="admin"?"Administrador":a.role==="analyst"?"Analista":"Stakeholder"})]})]})]}),e.jsxs(P,{className:"md:col-span-3",children:[e.jsxs(g,{children:[e.jsx(y,{children:"Configuración de Cuenta"}),e.jsx(N,{children:"Administra tu información y seguridad"})]}),e.jsx(C,{children:e.jsxs(B,{defaultValue:"profile",children:[e.jsxs(G,{className:"mb-4",children:[e.jsx(b,{value:"profile",children:"Perfil"}),e.jsx(b,{value:"password",children:"Contraseña"})]}),e.jsx(A,{value:"profile",children:e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"full_name",children:[e.jsx(D,{className:"h-4 w-4 inline mr-1"}),"Nombre Completo"]}),e.jsx(o,{id:"full_name",name:"full_name",value:u.full_name,onChange:j,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"email",children:[e.jsx(K,{className:"h-4 w-4 inline mr-1"}),"Correo Electrónico"]}),e.jsx(o,{id:"email",name:"email",type:"email",value:u.email,onChange:j,required:!0})]}),e.jsx(w,{type:"submit",disabled:d,children:d?"Guardando...":"Guardar Cambios"})]})}),e.jsx(A,{value:"password",children:e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"currentPassword",children:[e.jsx(U,{className:"h-4 w-4 inline mr-1"}),"Contraseña Actual"]}),e.jsx(o,{id:"currentPassword",name:"currentPassword",type:"password",value:n.currentPassword,onChange:h,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"newPassword",children:"Nueva Contraseña"}),e.jsx(o,{id:"newPassword",name:"newPassword",type:"password",value:n.newPassword,onChange:h,required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"La contraseña debe tener al menos 8 caracteres."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"confirmPassword",children:"Confirmar Nueva Contraseña"}),e.jsx(o,{id:"confirmPassword",name:"confirmPassword",type:"password",value:n.confirmPassword,onChange:h,required:!0})]}),e.jsx(w,{type:"submit",disabled:d,children:d?"Actualizando...":"Actualizar Contraseña"})]})})]})})]})]})]}):null};export{X as default};
