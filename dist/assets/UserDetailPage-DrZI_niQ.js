import{f as x,d as D,u as E,e as S,b as U,r as c,j as e,B as r,L as i,g as L,A as P,o as M,q as T,s as V,n as q,v as f}from"./index-CROi_bFZ.js";import{C as p,a as y,b as g,c as v,d as N}from"./card-B-0H7GP8.js";import{A as z,a as I,b as _,c as H,d as R,e as B,f as F,g as O,h as $}from"./alert-dialog-AYtEr9F3.js";import{A as k}from"./arrow-left-BPDy95mI.js";import{P as G}from"./pen-square-XLOe6YhH.js";import{M as J}from"./mail-B2Msq4VA.js";const K=x("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Q=x("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),W=x("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),re=()=>{const{id:l}=D(),{user:a}=E(),n=S(),{toast:t}=U(),[s,A]=c.useState(null),[b,d]=c.useState(!0),[C,h]=c.useState(!1),o=(a==null?void 0:a.role)==="admin",u=(a==null?void 0:a.id)===Number(l);c.useEffect(()=>{o?(async()=>{try{d(!0);const m=await f.getUser(l);A(m.data.data.user)}catch(m){console.error("Error fetching user:",m),t({variant:"destructive",title:"Error",description:"No se pudo cargar la información del usuario."}),n("/users")}finally{d(!1)}})():d(!1)},[l,o,n,t]);const w=async()=>{if(u){t({variant:"destructive",title:"Operación no permitida",description:"No puedes eliminar tu propio usuario."});return}try{h(!0),await f.deleteUser(l),t({title:"Usuario eliminado",description:"El usuario ha sido eliminado exitosamente."}),n("/users")}catch(j){console.error("Error deleting user:",j),t({variant:"destructive",title:"Error",description:"No se pudo eliminar el usuario. Inténtalo de nuevo."}),h(!1)}};return o?b?e.jsx(L,{fullScreen:!1}):s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(r,{variant:"ghost",size:"sm",asChild:!0,className:"mr-2",children:e.jsxs(i,{to:"/users",children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),"Volver"]})}),e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Detalles del Usuario"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{asChild:!0,size:"sm",children:e.jsxs(i,{to:`/users/${s.id}/edit`,children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Editar"]})}),e.jsxs(z,{children:[e.jsx(I,{asChild:!0,children:e.jsxs(r,{variant:"destructive",size:"sm",disabled:u,children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Eliminar"]})}),e.jsxs(_,{children:[e.jsxs(H,{children:[e.jsx(R,{children:"¿Estás seguro?"}),e.jsx(B,{children:"Esta acción no se puede deshacer. Se eliminará permanentemente el usuario y todos sus datos asociados."})]}),e.jsxs(F,{children:[e.jsx(O,{children:"Cancelar"}),e.jsx($,{onClick:w,className:"bg-destructive text-destructive-foreground",children:C?"Eliminando...":"Eliminar"})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(p,{children:[e.jsxs(y,{children:[e.jsx(g,{children:"Información del Usuario"}),e.jsx(v,{children:"Datos personales y de contacto"})]}),e.jsx(N,{className:"space-y-6",children:e.jsxs("div",{className:"flex flex-col items-center sm:flex-row sm:items-start gap-4",children:[e.jsxs(P,{className:"h-24 w-24",children:[e.jsx(M,{src:"/placeholder.svg",alt:s.full_name}),e.jsx(T,{className:"text-2xl",children:V(s.full_name)})]}),e.jsxs("div",{className:"space-y-1 text-center sm:text-left",children:[e.jsx("h3",{className:"text-xl font-semibold",children:s.full_name}),e.jsxs("div",{className:"flex items-center justify-center sm:justify-start text-muted-foreground",children:[e.jsx(J,{className:"mr-1 h-4 w-4"}),e.jsx("span",{children:s.email})]}),e.jsxs("div",{className:"flex items-center justify-center sm:justify-start text-muted-foreground",children:[e.jsx(W,{className:"mr-1 h-4 w-4"}),e.jsx("span",{className:"capitalize",children:s.role==="admin"?"Administrador":s.role==="analyst"?"Analista":"Stakeholder"})]}),s.created_at&&e.jsxs("div",{className:"flex items-center justify-center sm:justify-start text-muted-foreground",children:[e.jsx(K,{className:"mr-1 h-4 w-4"}),e.jsxs("span",{children:["Creado el ",q(s.created_at)]})]})]})]})})]}),e.jsxs(p,{children:[e.jsxs(y,{children:[e.jsx(g,{children:"Actividad del Usuario"}),e.jsx(v,{children:"Resumen de actividades y proyectos"})]}),e.jsx(N,{children:e.jsx("div",{className:"space-y-4",children:s.role==="analyst"?e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Proyectos Asignados"}),e.jsx("p",{className:"text-muted-foreground",children:"Para ver los proyectos asignados a este analista, consulta la sección de proyectos."}),e.jsx(r,{asChild:!0,variant:"outline",className:"mt-4",children:e.jsx(i,{to:"/projects",children:"Ver Proyectos"})})]}):e.jsx("p",{className:"text-muted-foreground",children:"La información de actividad no está disponible para este tipo de usuario."})})})]})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Usuario no encontrado"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"El usuario que buscas no existe o ha sido eliminado."}),e.jsx(r,{asChild:!0,children:e.jsxs(i,{to:"/users",children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Volver a usuarios"]})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Acceso Restringido"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No tienes permisos para acceder a esta sección."}),e.jsx(r,{asChild:!0,children:e.jsx(i,{to:"/dashboard",children:"Volver al Dashboard"})})]})};export{re as default};
