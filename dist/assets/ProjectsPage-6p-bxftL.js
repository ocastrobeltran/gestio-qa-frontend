import{u as w,r as l,j as e,g as E,B as p,L as x,p as P}from"./index-CROi_bFZ.js";import{I as T}from"./input-BF63-rU5.js";import{S as k,a as A,b as L,c as F,d as i}from"./select-B-rD1Ibz.js";import{S as B,F as I,T as D,a as H,b as h,c as r,d as V,e as t}from"./table-DJPnixqN.js";import{C as $,a as Q,b as R,c as _,d as q}from"./card-B-0H7GP8.js";import{P as z}from"./plus-C9L6BQP6.js";const W=()=>{const{user:n}=w(),[u,g]=l.useState([]),[j,m]=l.useState([]),[b,f]=l.useState(!0),[c,v]=l.useState(""),[d,C]=l.useState(""),y=(n==null?void 0:n.role)==="admin",S=(n==null?void 0:n.role)==="analyst",N=y||S;return l.useEffect(()=>{(async()=>{try{f(!0);const a=await P.getProjects();g(a.data.data.projects),m(a.data.data.projects)}catch(a){console.error("Error fetching projects:",a)}finally{f(!1)}})()},[]),l.useEffect(()=>{let s=[...u];if(c){const a=c.toLowerCase();s=s.filter(o=>o.title.toLowerCase().includes(a)||o.client.toLowerCase().includes(a)||o.initiative.toLowerCase().includes(a))}d&&(s=s.filter(a=>a.status===d)),m(s)},[c,d,u]),b?e.jsx(E,{fullScreen:!1}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Proyectos"}),N&&e.jsx(p,{asChild:!0,children:e.jsxs(x,{to:"/projects/create",children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Nuevo Proyecto"]})})]}),e.jsxs($,{children:[e.jsxs(Q,{children:[e.jsx(R,{children:"Lista de Proyectos"}),e.jsx(_,{children:"Gestiona todos los proyectos de QA en el sistema"})]}),e.jsxs(q,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(B,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(T,{type:"search",placeholder:"Buscar por título, cliente o iniciativa...",className:"pl-8",value:c,onChange:s=>v(s.target.value)})]}),e.jsx("div",{className:"w-full md:w-[200px]",children:e.jsxs(k,{value:d,onValueChange:C,children:[e.jsx(A,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),e.jsx(L,{placeholder:"Filtrar por estado"})]})}),e.jsxs(F,{children:[e.jsx(i,{value:"all",children:"Todos los estados"}),e.jsx(i,{value:"En análisis",children:"En análisis"}),e.jsx(i,{value:"En validación",children:"En validación"}),e.jsx(i,{value:"En pruebas",children:"En pruebas"}),e.jsx(i,{value:"Aprobado",children:"Aprobado"}),e.jsx(i,{value:"Cancelado",children:"Cancelado"})]})]})})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(D,{children:[e.jsx(H,{children:e.jsxs(h,{children:[e.jsx(r,{children:"Título"}),e.jsx(r,{children:"Cliente"}),e.jsx(r,{children:"Iniciativa"}),e.jsx(r,{children:"Estado"}),e.jsx(r,{children:"Analista QA"}),e.jsx(r,{children:"Fecha Creación"}),e.jsx(r,{className:"text-right",children:"Acciones"})]})}),e.jsx(V,{children:j.length>0?j.map(s=>{var a;return e.jsxs(h,{children:[e.jsx(t,{className:"font-medium",children:e.jsx(x,{to:`/projects/${s.id}`,className:"hover:underline text-primary",children:s.title})}),e.jsx(t,{children:s.client}),e.jsx(t,{children:s.initiative}),e.jsx(t,{children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${s.status==="Aprobado"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":s.status==="Cancelado"?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300":s.status==="En pruebas"?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300":s.status==="En validación"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"}`,children:s.status})}),e.jsx(t,{children:((a=s.qaAnalyst)==null?void 0:a.full_name)||"Sin asignar"}),e.jsx(t,{children:new Date(s.created_at).toLocaleDateString()}),e.jsx(t,{className:"text-right",children:e.jsx(p,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(x,{to:`/projects/${s.id}`,children:"Ver detalles"})})})]},s.id)}):e.jsx(h,{children:e.jsx(t,{colSpan:7,className:"h-24 text-center",children:"No se encontraron proyectos"})})})]})})]})]})]})};export{W as default};
